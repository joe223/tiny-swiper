{"version":3,"file":"index.esm.js","sources":["../src/core/render/dom.ts","../src/modules/lazyload.ts","../src/modules/pagination.ts","../src/modules/keyboardControl.ts","../src/modules/mousewheel.ts","../src/modules/navigation.ts","../src/core/render/timing.ts","../src/core/eventHub.ts","../src/core/render/nextTick.ts","../src/modules/breakpoints.ts","../src/core/render/layout.ts","../src/core/options.ts","../src/core/state/trace.ts","../src/core/state/index.ts","../src/core/render/animation.ts","../src/core/sensor/actions.ts","../src/core/sensor/index.ts","../src/core/env/measure.ts","../src/core/env/limitation.ts","../src/core/env/index.ts","../src/core/render/index.ts","../src/core/state/operations.ts","../src/core/env/element.ts","../src/core/index.ts"],"sourcesContent":["export function addClass (\n    el: HTMLElement,\n    list: Array<string> | string = []\n): void {\n    if (!Array.isArray(list)) list = [list]\n\n    list.forEach(clz => (!el.classList.contains(clz) && el.classList.add(clz)))\n}\n\nexport function removeClass (\n    el: HTMLElement,\n    list: Array<string> | string = []\n): void {\n    if (!Array.isArray(list)) list = [list]\n\n    list.forEach(clz => (el.classList.contains(clz) && el.classList.remove(clz)))\n}\n\nexport function attachListener (\n    el: HTMLElement | Document | Window,\n    evtName: string,\n    handler: EventListenerOrEventListenerObject,\n    opts?: boolean | AddEventListenerOptions\n): void {\n    el.addEventListener(evtName, handler, opts)\n}\n\nexport function detachListener (\n    el: HTMLElement | Document | Window,\n    evtName: string,\n    handler: EventListenerOrEventListenerObject\n): void {\n    el.removeEventListener(evtName, handler)\n}\n\nexport function removeAttr (\n    el: HTMLElement,\n    attr: string\n): void {\n    el.removeAttribute(attr)\n}\n\nexport function setAttr (\n    el: HTMLElement,\n    attr: string,\n    value = ''\n): HTMLElement {\n    el.setAttribute(attr, value)\n    return el\n}\n\nexport function setStyle (\n    el: HTMLElement,\n    style: {[key: string]: string},\n    forceRender?: boolean\n): HTMLElement {\n    Object.keys(style).forEach(prop => {\n        // TS7015: Element implicitly has an 'any' type because index expression is not of type 'number'.\n        el.style[prop as any] = style[prop]\n    })\n    // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n    forceRender && getComputedStyle(el)\n\n    return el\n}\n\nexport function getTranslate (\n    el: HTMLElement,\n    isHorizontal: boolean\n): number {\n    const matrix = getComputedStyle(el).transform.replace(/[a-z]|\\(|\\)|\\s/g, '').split(',').map(parseFloat)\n    let arr: Array<number> = []\n\n    if (matrix.length === 16) {\n        arr = matrix.slice(12, 14)\n    } else if (matrix.length === 6) {\n        arr = matrix.slice(4, 6)\n    }\n    return (<Array<number>>arr)[isHorizontal ? 0 : 1] || 0\n}\n\nexport function stringToElement (\n    string: string\n): HTMLElement {\n    const wrapper = document.createElement('div')\n    wrapper.innerHTML = string\n    return wrapper.firstChild as HTMLElement\n}\n","import {\n    addClass,\n    removeClass\n} from '../core/render/dom'\nimport { SwiperInstance, SwiperPlugin } from '../core/index'\nimport { Options } from '../core/options'\nimport { State } from '../core/state/index'\n\nexport type SwiperPluginLazyloadOptions = {\n    loadPrevNext: boolean\n    loadPrevNextAmount: number\n    loadOnTransitionStart: boolean\n    elementClass: string\n    loadingClass: string\n    loadedClass: string\n    preloaderClass: string\n}\n\nexport type SwiperPluginLazyloadPartialOptions = Partial<SwiperPluginLazyloadOptions> | boolean\n\nexport type SwiperPluginLazyloadHTMLElement = HTMLImageElement & {\n    isLoaded: boolean\n}\n\nexport type SwiperPluginLazyloadInstance = {\n    load (index: number): void\n    loadRange (\n        index: number,\n        range: number\n    ): void\n}\n\n/**\n * TinySwiper plugin for image lazy loading.\n *\n * @param {SwiperInstance} instance\n * @param {Options}\n */\nexport default <SwiperPlugin>function SwiperPluginLazyload (\n    instance: SwiperInstance & {\n        lazyload?: SwiperPluginLazyloadInstance\n    },\n    options: Options & {\n        lazyload?: SwiperPluginLazyloadPartialOptions\n    }\n) {\n    const isEnable = Boolean(options.lazyload)\n    const lazyloadOptions = <SwiperPluginLazyloadOptions>Object.assign({\n        loadPrevNext: false,\n        loadPrevNextAmount: 1,\n        loadOnTransitionStart: false,\n        elementClass: 'swiper-lazy',\n        loadingClass: 'swiper-lazy-loading',\n        loadedClass: 'swiper-lazy-loaded',\n        preloaderClass: 'swiper-lazy-preloader'\n    }, options.lazyload)\n    const lazyload: SwiperPluginLazyloadInstance = {\n        load (index: number): void {\n            const $slide = instance.env.element.$list[index]\n\n            if (!$slide) return\n\n            const $imgs = [].slice.call($slide.getElementsByClassName(lazyloadOptions.elementClass))\n            const $preloaders: HTMLElement[] = [].slice.call($slide.getElementsByClassName(lazyloadOptions.preloaderClass))\n\n            function handleLoaded ($img: SwiperPluginLazyloadHTMLElement) {\n                $img.removeAttribute('data-src')\n                addClass($img, [lazyloadOptions.loadedClass])\n                removeClass($img, [lazyloadOptions.loadingClass])\n                $img.onload = null\n                $img.onerror = null\n                $img.isLoaded = true\n\n                if ($imgs.every((item: SwiperPluginLazyloadHTMLElement) => item.isLoaded)) {\n                    $preloaders.forEach(($preloader: HTMLElement) => {\n                        $preloader.parentElement!.removeChild($preloader)\n                    })\n                }\n            }\n\n            $imgs.forEach(($img: SwiperPluginLazyloadHTMLElement) => {\n                if (!$img.hasAttribute('data-src')) return\n\n                const src = $img.getAttribute('data-src')\n\n                addClass($img, [lazyloadOptions.loadingClass])\n                removeClass($img, [lazyloadOptions.loadedClass])\n                $img.src = src as string\n                $img.onload = () => handleLoaded($img)\n                $img.onerror = () => handleLoaded($img)\n            })\n        },\n\n        loadRange (\n            index: number,\n            range: number\n        ): void {\n            lazyload.load(index)\n\n            if (lazyloadOptions.loadPrevNext && range >= 1) {\n                for (let i = 1; i <= range; i++) {\n                    lazyload.load(index + i)\n                    lazyload.load(index - i)\n                }\n            }\n        }\n    }\n\n    if (!isEnable) return\n\n    instance.on('before-init', () => {\n        instance.lazyload = lazyload\n    })\n\n    if (lazyloadOptions.loadOnTransitionStart) {\n        instance.on('before-slide', (\n            oldIndex: number,\n            state: State,\n            newIndex: number\n        ) => {\n            lazyload.loadRange(newIndex, lazyloadOptions.loadPrevNextAmount)\n        })\n    } else {\n        instance.on('after-slide', (\n            index: number\n        ) => {\n            lazyload.loadRange(index, lazyloadOptions.loadPrevNextAmount)\n        })\n    }\n\n    instance.on('after-destroy', () => {\n        if (instance.lazyload) {\n            delete instance.lazyload\n        }\n    })\n}\n","import {\n    addClass,\n    removeClass,\n    stringToElement\n} from '../core/render/dom'\nimport { SwiperInstance, SwiperPlugin } from '../core/index'\nimport { Options } from '../core/options'\n\nexport type SwiperPluginPaginationOptions = {\n    el: string\n    clickable: boolean\n    clickableClass: 'swiper-pagination-clickable'\n    bulletClass: string | 'swiper-pagination-bullet'\n    bulletActiveClass: string | 'swiper-pagination-bullet-active'\n    renderBullet: Function\n}\n\nexport type SwiperPluginPaginationPartialOptions = Partial<SwiperPluginPaginationOptions>\n\nexport type SwiperPluginPaginationInstance = {\n    $pageList: HTMLElement[]\n    $pagination: HTMLElement | null\n}\n\nexport default <SwiperPlugin>function SwiperPluginPagination (\n    instance: SwiperInstance & {\n        pagination?: SwiperPluginPaginationInstance\n    },\n    options: Options & {\n        pagination?: SwiperPluginPaginationPartialOptions\n    }\n) {\n    const isEnable = Boolean(options.pagination)\n    const paginationOptions = <SwiperPluginPaginationOptions>Object.assign({\n        clickable: false,\n        bulletClass: 'swiper-pagination-bullet',\n        bulletActiveClass: 'swiper-pagination-bullet-active',\n        clickableClass: 'swiper-pagination-clickable'\n    }, options.pagination)\n    const paginationInstance = {\n        $pageList: [],\n        $pagination: null\n    } as unknown as SwiperPluginPaginationInstance\n\n    if (!isEnable) return\n\n    instance.on('after-init', () => {\n        const {\n            bulletClass,\n            bulletActiveClass,\n            clickableClass,\n            renderBullet\n        } = <SwiperPluginPaginationOptions>paginationOptions\n        const {\n            element\n        } = instance.env\n        const {\n            $list\n        } = element\n\n        const $pagination = (typeof paginationOptions.el === 'string'\n            ? document.body.querySelector(paginationOptions.el)\n            : paginationOptions.el) as HTMLElement\n        const $pageList: Array<HTMLElement> = []\n        const $group = document.createDocumentFragment()\n        const dotCount = $list.length - Math.ceil(options.slidesPerView) + 1\n\n        options.excludeElements.push($pagination as HTMLElement)\n\n        paginationInstance.$pagination = $pagination\n        paginationInstance.$pageList = $pageList\n\n        for (let index = 0; index < dotCount; index++) {\n            const $page = renderBullet ? stringToElement(renderBullet(index, bulletClass)) : document.createElement('div')\n\n            addClass(\n                $page,\n                index === instance.state.index ? [bulletClass, bulletActiveClass] : bulletClass\n            )\n            $pageList.push($page)\n            $group.appendChild($page)\n        }\n\n        $pagination.appendChild($group)\n\n        if (paginationOptions.clickable) {\n            addClass($pagination, clickableClass)\n\n            $pagination.addEventListener('click', (e: Event) => {\n                const target = e.target as HTMLElement\n                if (!target) return\n                e.preventDefault()\n                const bulletElement = target.closest(`.${bulletClass}`)\n                instance.slideTo($pageList.indexOf(bulletElement as HTMLElement))\n                e.stopPropagation()\n            })\n        }\n    })\n\n    instance.on('after-destroy', () => {\n        if (!isEnable) return\n\n        paginationInstance.$pagination!.innerHTML = ''\n        paginationInstance.$pageList = []\n        paginationInstance.$pagination = null\n    })\n\n    instance.on('after-slide', (\n        currentIndex: number\n    ) => {\n        const { bulletActiveClass } = paginationOptions\n\n        paginationInstance.$pageList && paginationInstance.$pageList.forEach(($page, index) => {\n            if (index === currentIndex) {\n                addClass($page, bulletActiveClass)\n            } else {\n                removeClass($page, bulletActiveClass)\n            }\n        })\n    })\n}\n","import {\n    attachListener,\n    detachListener\n} from '../core/render/dom'\nimport { SwiperInstance, SwiperPlugin } from '../core/index'\nimport { Options } from '../core/options'\n\nexport type SwiperPluginKeyboardControlOptions = {\n    enabled: boolean\n    onlyInViewport: boolean\n}\n\nexport type SwiperPluginKeyboardControlPartialOptions = Partial<SwiperPluginKeyboardControlOptions> | boolean\n\nexport type SwiperPluginKeyboardInstance = {\n    onKeyDown (e: Event): void\n    enable (): void\n    disable (): void\n}\n\nconst DIRECTION = {\n    up: 'ArrowUp',\n    right: 'ArrowRight',\n    down: 'ArrowDown',\n    left: 'ArrowLeft'\n}\n\n// TODO: optimize\nfunction isVisible (el: HTMLElement): boolean {\n    if (!el) return false\n\n    const style = getComputedStyle(el)\n    const visible = style.visibility !== 'hidden' && style.display !== 'none'\n\n    if (!visible) return false\n\n    return el.parentElement && el.parentElement.nodeType === 1\n        ? isVisible(el.parentElement)\n        : true\n}\n\nfunction isElementInView (el: HTMLElement): boolean {\n    const visibility = isVisible(el)\n    const boundary = el.getBoundingClientRect()\n    const isInView = (boundary.top >= 0 && boundary.bottom <= window.innerHeight)\n        && (boundary.left >= 0 && boundary.right <= window.innerWidth)\n\n    return isInView && visibility\n}\n\n/**\n * TinySwiper plugin for keyboard control.\n *\n * @param {SwiperInstance} instance\n * @param {Options}\n */\nexport default <SwiperPlugin>function SwiperPluginKeyboardControl (\n    instance: SwiperInstance & {\n        keyboard?: SwiperPluginKeyboardInstance\n    },\n    options: Options\n): void {\n    const isEnable = Boolean(options.keyboard)\n    const keyboardOptions = <SwiperPluginKeyboardControlOptions>Object.assign({\n        enabled: true,\n        onlyInViewport: true\n    }, options.keyboard)\n    const keyboard: SwiperPluginKeyboardInstance = {\n        enable (): void {\n            keyboardOptions.enabled = true\n        },\n        disable (): void {\n            keyboardOptions.enabled = false\n        },\n        onKeyDown (e: KeyboardEvent): void {\n            const { key } = e\n\n            if ((keyboardOptions.onlyInViewport && !isElementInView(instance.env.element.$el))\n                || !keyboardOptions.enabled) return\n\n            if (options.isHorizontal) {\n                if (key === DIRECTION.left) {\n                    instance.slideTo(instance.state.index - 1)\n                } else if (key === DIRECTION.right) {\n                    instance.slideTo(instance.state.index + 1)\n                }\n            } else {\n                if (key === DIRECTION.down) {\n                    instance.slideTo(instance.state.index - 1)\n                } else if (key === DIRECTION.up) {\n                    instance.slideTo(instance.state.index + 1)\n                }\n            }\n        }\n    }\n\n    if (!isEnable) return\n\n    instance.on('before-init', () => {\n        instance.keyboard = keyboard\n\n        attachListener(window, 'keydown', keyboard.onKeyDown as EventListener)\n    })\n\n    instance.on('after-destroy', () => {\n        if (instance!.keyboard) {\n            detachListener(window, 'keydown', keyboard.onKeyDown as EventListener)\n\n            delete instance.keyboard\n        }\n    })\n}\n","import {\n    attachListener,\n    detachListener\n} from '../core/render/dom'\nimport { SwiperInstance, SwiperPlugin } from '../core/index'\nimport { Options } from '../core/options'\n\nexport type SwiperPluginMousewheelOptions = {\n    invert: boolean\n    sensitivity: number\n    interval: number\n}\n\nexport type SwiperPluginMousewheelPartialOptions = Partial<SwiperPluginMousewheelOptions>\n\nexport type SwiperPluginMousewheelInstance = {\n    $el?: HTMLElement\n}\n\nexport default <SwiperPlugin>function SwiperPluginMousewheel (\n    instance: SwiperInstance & {\n        mousewheel?: SwiperPluginMousewheelInstance\n    },\n    options: Options & {\n        mousewheel?: SwiperPluginMousewheelPartialOptions\n    }\n) {\n    const isEnable = Boolean(options.mousewheel)\n    const mousewheelOptions = <SwiperPluginMousewheelOptions>Object.assign({\n        invert: false,\n        sensitivity: 1,\n        interval: 400\n    }, options.mousewheel)\n    const mousewheelInstance = {\n        $el: null\n    } as unknown as SwiperPluginMousewheelInstance\n    const wheelStatus = {\n        wheeling: false,\n        wheelDelta: 0,\n        wheelingTimer: 0\n    }\n    const handler = (e: WheelEvent) => {\n        const isHorizontal = Math.abs(e.deltaX) > Math.abs(e.deltaY)\n\n        if (options.isHorizontal !== isHorizontal) return\n\n        const delta = isHorizontal\n            ? e.deltaX\n            : e.deltaY\n        const {\n            index\n        } = instance.state\n\n        if ((Math.abs(delta) - Math.abs(wheelStatus.wheelDelta) > 0)\n            && !wheelStatus.wheeling\n            && Math.abs(delta) >= mousewheelOptions.sensitivity\n        ) {\n            const step = mousewheelOptions.invert ? 1 : -1\n\n            instance.slideTo(delta > 0\n                ? index - step\n                : index + step\n            )\n            wheelStatus.wheeling = true\n            wheelStatus.wheelingTimer = setTimeout(() => {\n                wheelStatus.wheeling = false\n            }, mousewheelOptions.interval) as unknown as number\n        }\n        wheelStatus.wheelDelta = delta\n        e.preventDefault()\n        e.stopPropagation()\n    }\n\n    instance.on('after-init', () => {\n        if (!isEnable) return\n\n        const {\n            element\n        } = instance.env\n        const {\n            $el\n        } = element\n\n        mousewheelInstance.$el = $el\n\n        attachListener($el, 'wheel', <EventListener>handler)\n    })\n\n    instance.on('after-destroy', () => {\n        if (!isEnable) return\n\n        detachListener(<HTMLElement>mousewheelInstance.$el, 'wheel', <EventListener>handler)\n\n        delete mousewheelInstance.$el\n    })\n}\n","import {\n    attachListener,\n    detachListener\n} from '../core/render/dom'\nimport { SwiperInstance, SwiperPlugin } from '../core/index'\nimport { Options } from '../core/options'\n\nexport type SwiperPluginNavigationOptions = {\n    nextEl: HTMLElement | string\n    prevEl: HTMLElement | string\n    disabledClass: string\n}\n\nexport type SwiperPluginNavigationPartialOptions = Partial<SwiperPluginNavigationOptions>\n\nexport type SwiperPluginNavigationInstance = {\n    nextEl?: HTMLElement\n    prevEl?: HTMLElement\n}\n\nexport default <SwiperPlugin>function SwiperPluginNavigation (\n    instance: SwiperInstance & {\n        navigation?: SwiperPluginNavigationInstance\n    },\n    options: Options & {\n        navigation?: SwiperPluginNavigationPartialOptions\n    }\n) {\n    const isEnable = Boolean(options.navigation)\n    const navigationInstance = {\n        nextEl: null,\n        prevEl: null\n    } as unknown as SwiperPluginNavigationInstance\n    const navigationOptions = <SwiperPluginNavigationOptions>Object.assign({\n        disabledClass: 'swiper-button-disabled'\n    }, options.navigation)\n    const nextClickHandler = (e: PointerEvent) => {\n        clickHandler(e.target as HTMLElement, 'next')\n    }\n\n    const prevClickHandler = (e: PointerEvent) => {\n        clickHandler(e.target as HTMLElement, 'prev')\n    }\n\n    const clickHandler = (e: HTMLElement, type: 'next' | 'prev') => {\n        if (checkIsDisable(e) && !instance.options.loop) {\n            return\n        }\n        const {\n            index\n        } = instance.state\n\n        if (type === 'next') {\n            instance.slideTo(index + 1)\n        }\n\n        if (type === 'prev') {\n            instance.slideTo(index - 1)\n        }\n    }\n\n    const checkNavBtnDisabledClass = (index: number) => {\n        const {\n            minIndex,\n            maxIndex\n        } = instance.env.limitation\n        if (\n            navigationInstance\n            && navigationInstance!.prevEl\n            && navigationInstance!.nextEl\n        ) {\n            if (navigationInstance.nextEl.classList.contains(navigationOptions.disabledClass)\n                && index >= minIndex) {\n                navigationInstance.nextEl.classList.remove(navigationOptions.disabledClass)\n            }\n            if (navigationInstance.prevEl.classList.contains(navigationOptions.disabledClass)\n                && index <= maxIndex) {\n                navigationInstance.prevEl.classList.remove(navigationOptions.disabledClass)\n            }\n\n            if (index === minIndex) {\n                navigationInstance.prevEl.classList.add(navigationOptions.disabledClass)\n            }\n            if (index === maxIndex) {\n                navigationInstance.nextEl.classList.add(navigationOptions.disabledClass)\n            }\n        }\n    }\n\n    const checkIsDisable = (e: HTMLElement) => {\n        return e.classList.contains(navigationOptions.disabledClass)\n    }\n\n    const checkButtonDefaultStatus = () => {\n        const {\n            index\n        } = instance.state\n        const {\n            $list\n        } = instance.env.element\n        const {\n            minIndex\n        } = instance.env.limitation\n        if (index === minIndex\n            && navigationInstance.prevEl\n        ) {\n            navigationInstance.prevEl.classList.add(navigationOptions.disabledClass)\n        }\n        if ($list.length === minIndex\n            && navigationInstance.nextEl\n        ) {\n            navigationInstance.nextEl.classList.add(navigationOptions.disabledClass)\n        }\n    }\n\n    instance.on('before-slide', (currentIndex: number, state: never, newIndex: number) => {\n        if (!instance.options.loop) {\n            checkNavBtnDisabledClass(newIndex)\n        }\n    })\n\n    instance.on('after-init', () => {\n        if (!isEnable) return\n\n        navigationInstance.nextEl = (typeof navigationOptions.nextEl === 'string')\n            ? document.body.querySelector(navigationOptions.nextEl) as HTMLElement\n            : navigationOptions.nextEl\n        navigationInstance.prevEl = (typeof navigationOptions.prevEl === 'string')\n            ? document.body.querySelector(navigationOptions.prevEl) as HTMLElement\n            : navigationOptions.prevEl\n\n        if (!instance.options.loop) {\n            checkButtonDefaultStatus()\n        }\n        attachListener(<HTMLElement>navigationInstance.nextEl, 'click', <EventListener> nextClickHandler)\n        attachListener(<HTMLElement>navigationInstance.prevEl, 'click', <EventListener> prevClickHandler)\n    })\n\n    instance.on('after-destroy', () => {\n        if (navigationInstance\n            && navigationInstance.prevEl\n            && navigationInstance.nextEl\n        ) {\n            detachListener(<HTMLElement>navigationInstance.nextEl, 'click', <EventListener> nextClickHandler)\n            detachListener(<HTMLElement>navigationInstance.prevEl, 'click', <EventListener> prevClickHandler)\n\n            delete navigationInstance.nextEl\n            delete navigationInstance.prevEl\n        }\n    })\n}\n","import {cancelNextFrame, nextFrame} from './nextTick'\n\ntype DebounceOptions = {\n    trailing: boolean\n}\n\nexport function now () {\n    return performance ? performance.now() : Date.now()\n}\n\nexport function debounce <T extends (...args: any) => any> (fn: T, threshold = 200, opt: DebounceOptions = {\n    trailing: true\n}): T {\n    let lastCallTime: DOMHighResTimeStamp = 0\n    let lastResult: ReturnType<T>\n    let lastTimer: NodeJS.Timer | undefined\n\n    return function (...args) {\n        const currTime = now()\n\n        if (currTime - lastCallTime >= threshold) {\n            lastCallTime = currTime\n            lastTimer = void 0\n            lastResult = fn(...args)\n        }\n\n        if (opt.trailing) {\n            lastTimer && clearTimeout(lastTimer)\n            lastTimer = setTimeout(() => fn(...args), threshold)\n        }\n\n        return lastResult\n    } as T\n}\n","export type EventHub = {\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    on (evtName: string, cb: Function): void\n    off (evtName: string, cb: Function): void\n    emit (evtName: string, ...data: Array<any>): void\n    clear (): void\n}\n\nexport const LIFE_CYCLES = {\n    BEFORE_INIT: 'before-init',\n    AFTER_INIT: 'after-init',\n    BEFORE_SLIDE: 'before-slide',\n    SCROLL: 'scroll',\n    AFTER_SLIDE: 'after-slide',\n    BEFORE_DESTROY: 'before-destroy',\n    AFTER_DESTROY: 'after-destroy'\n}\n\nexport function EventHub (): EventHub {\n    let hub: {\n        [key: string]: Array<Function>\n    } = {}\n\n    function on (evtName: string, cb: Function): void {\n        if (!hub[evtName]) {\n            hub[evtName] = [cb]\n        } else {\n            hub[evtName].push(cb)\n        }\n    }\n\n    function off (evtName: string, cb: Function): void {\n        if (hub[evtName]) {\n            const index = hub[evtName].indexOf(cb)\n\n            // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n            index > -1 && hub[evtName].splice(index, 1)\n        }\n    }\n\n    function emit (evtName: string, ...data: Array<any>): void {\n        if (hub[evtName]) {\n            hub[evtName].forEach(cb => cb(...data))\n        }\n    }\n\n    function clear (): void {\n        hub = {}\n    }\n\n    return {\n        on,\n        off,\n        emit,\n        clear\n    }\n}\n","import { now } from './timing'\n\nexport type Tick = {\n    run (cb: (interval: DOMHighResTimeStamp) => void): void\n    stop (): void\n}\n\nexport const nextFrame = requestAnimationFrame || webkitRequestAnimationFrame || setTimeout\nexport const cancelNextFrame = cancelAnimationFrame || webkitCancelAnimationFrame || clearTimeout\n\nexport function Tick (): Tick {\n    let startTime: number | undefined\n    let id: number\n\n    function run (cb: (interval: DOMHighResTimeStamp) => void): void {\n        // eslint-disable-next-line no-void\n        startTime = startTime === void 0\n            ? now()\n            : startTime\n\n        // Why do not use callback argument:\n        // https://stackoverflow.com/questions/50895206/exact-time-of-display-requestanimationframe-usage-and-timeline\n        id = nextFrame(() => {\n            const timeStamp = now()\n            const interval = timeStamp - <number>startTime\n\n            startTime = timeStamp\n            cb(interval)\n        })\n    }\n\n    function stop (): void {\n        startTime = undefined\n        cancelNextFrame(id)\n    }\n\n    return {\n        run,\n        stop\n    }\n}\n","import { debounce } from '../core/render/timing'\nimport { Options, UserOptions } from '../core/options'\nimport { SwiperInstance, SwiperPlugin } from '../core/index'\nimport { LIFE_CYCLES } from '../core/eventHub'\nimport { nextFrame } from '../core/render/nextTick'\n\nexport type SwiperPluginBreakpointsInstance = {\n    update (): void\n}\nexport type SwiperPluginBreakpointsOptions = {\n    [key in number]: UserOptions\n}\n\n/**\n * TinySwiper plugin for breakpoints.\n *\n * @param {SwiperInstance} instance\n * @param {Options}\n */\nexport default <SwiperPlugin>function SwiperPluginBreakpoints (\n    instance: SwiperInstance & {\n        breakpoints?: SwiperPluginBreakpointsInstance\n    },\n    options: Options & {\n        breakpoints?: SwiperPluginBreakpointsOptions\n        breakpointsBase?: string\n    }\n): void {\n    const isEnabled = Boolean(options.breakpoints)\n    const breakpoints: SwiperPluginBreakpointsInstance = {\n        update (): void {\n            \n            if (!options.breakpoints) return \n\n            for (const [breakpoint, values] of Object.entries(options.breakpoints)) {\n                if ('window' === options.breakpointsBase) {\n                    if (window.matchMedia(`(min-width: ${breakpoint}px)`).matches) {\n                        instance.options = Object.assign(instance.options, values)\n                    }\n                } else if (+breakpoint <= instance.env.element.$el.offsetWidth) {\n                    instance.options = Object.assign(instance.options, values)\n                }\n            }\n            nextFrame(instance.updateSize)\n        }\n    }\n\n    if (!isEnabled) return\n\n    const resizeListener = debounce(breakpoints.update, 200) // the default timeout is 200ms\n\n    instance.on(LIFE_CYCLES.AFTER_INIT, () => {\n        instance.breakpoints = breakpoints\n        window.addEventListener('resize', resizeListener, { passive: true })\n    })\n    instance.on(LIFE_CYCLES.BEFORE_DESTROY, () => {\n        window.removeEventListener('resize', resizeListener)\n    })\n}","import { State } from '../state/index'\nimport { Env } from '../env/index'\nimport { setStyle } from './dom'\nimport { Options } from '../options'\n\nexport function translate (\n    state: State,\n    env: Env,\n    options: Options,\n    duration: number\n): void {\n    const {\n        $wrapper\n    } = env.element\n    const wrapperStyle = {\n        transition: state.isStart\n            ? 'none'\n            : `transform ease ${duration}ms`,\n        transform: options.isHorizontal\n            ? `translate3d(${state.transforms}px, 0, 0)`\n            : `translate3d(0, ${state.transforms}px, 0)`\n    }\n\n    setStyle($wrapper, wrapperStyle)\n}\n","import { SwiperPlugin } from './index'\nimport { translate } from './render/layout'\nimport { State } from './state/index'\nimport { Env } from './env/index'\nimport { SwiperPluginLazyloadPartialOptions } from '../modules/lazyload'\nimport { SwiperPluginPaginationPartialOptions } from '../modules/pagination'\nimport { SwiperPluginKeyboardControlPartialOptions } from '../modules/keyboardControl'\nimport { SwiperPluginNavigationPartialOptions } from '../modules/navigation'\nimport { SwiperPluginMousewheelPartialOptions } from '../modules/mousewheel'\nimport { SwiperPluginAutoPlayPartialOptions } from '../modules/autoPlay'\n\nexport type Direction = 'horizontal' | 'vertical'\nexport type Injections = {\n    translate: (\n        state: State,\n        env: Env,\n        options: Options,\n        duration: number\n    ) => void\n}\n\nexport type Options = {\n    direction: Direction\n    touchRatio: number\n    touchAngle: number\n    longSwipesRatio: number\n    initialSlide: number\n    loop: boolean\n    freeMode: boolean\n    passiveListeners: boolean\n    resistance: boolean\n    resistanceRatio: number\n    speed: number\n    longSwipesMs: number\n    spaceBetween: number\n    slidesPerView: number\n    centeredSlides: boolean\n    slidePrevClass: string\n    slideNextClass: string\n    slideActiveClass: string\n    slideClass: string\n    wrapperClass: string\n    touchStartPreventDefault: boolean\n    touchStartForcePreventDefault: boolean\n    touchMoveStopPropagation: boolean\n    excludeElements: Array<HTMLElement>\n    isHorizontal: boolean\n    plugins?: Array<SwiperPlugin>\n    injections: Injections\n\n    // Plugins\n    lazyload?: SwiperPluginLazyloadPartialOptions\n    mousewheel?: SwiperPluginMousewheelPartialOptions\n    keyboard?: SwiperPluginKeyboardControlPartialOptions\n    navigation?: SwiperPluginNavigationPartialOptions\n    pagination?: SwiperPluginPaginationPartialOptions\n    autoplay?: SwiperPluginAutoPlayPartialOptions\n}\n\nexport type UserOptions = Partial<Options>\n\nexport const defaultOptions: UserOptions = {\n    // `isHorizontal` is computed value\n    direction: 'horizontal',\n    touchRatio: 1,\n    touchAngle: 45,\n    longSwipesRatio: 0.5,\n    initialSlide: 0,\n    loop: false,\n    freeMode: false,\n    passiveListeners: true,\n    resistance: true,\n    resistanceRatio: 0.85,\n    speed: 300,\n    longSwipesMs: 300,\n    spaceBetween: 0,\n    slidesPerView: 1,\n    centeredSlides: false,\n    slidePrevClass: 'swiper-slide-prev',\n    slideNextClass: 'swiper-slide-next',\n    slideActiveClass: 'swiper-slide-active',\n    slideClass: 'swiper-slide',\n    wrapperClass: 'swiper-wrapper',\n    touchStartPreventDefault: true,\n    touchStartForcePreventDefault: false,\n    touchMoveStopPropagation: false,\n    excludeElements: [],\n    injections: {\n        translate\n    }\n}\n\nexport function optionFormatter (userOptions?: UserOptions): Options {\n    const options = <Options>{\n        ...defaultOptions,\n        ...userOptions\n    }\n\n    return {\n        ...options,\n        isHorizontal: options.direction === 'horizontal'\n    }\n}\n","const delta = 180 / Math.PI\n\nexport type TraceLogs = Array<Trace>\n\nexport type Offset = {\n    /**\n     * offset x\n     */\n    x: number\n\n    /**\n     * offset y\n     */\n    y: number\n}\n\nexport type Position = {\n    /**\n     * postion in the x-axis\n     */\n    x: number\n\n    /**\n     * postion in the y-axis\n     */\n    y: number\n}\n\nexport type Trace = {\n    /**\n     * timestamp of current postion\n     */\n    time: number\n} & Position\n\nexport type Tracker = {\n    push (postion: Position): void\n    vector (): Vector\n    clear (): void\n    getLogs (): TraceLogs\n    getDuration (): number\n    getOffset (): Offset\n}\n\nexport type Vector = {\n    /**\n     * offset in the x-axis\n     */\n    x: number\n\n    /**\n     * offset in the y-axis\n     */\n    y: number\n\n    /**\n     * velocity in the x-axis\n     */\n    velocityX: number\n\n    /**\n     * velocity in the y-axis\n     */\n    velocityY: number\n\n    /**\n     * direction angle\n     */\n    angle: number\n}\n\nexport function Vector (\n    logs: TraceLogs,\n    index: number\n): Vector {\n    const trace = logs[index]\n    const formerTrace = logs[index - 1] || trace // In case click action, there will be only one log data\n    const diff = {\n        x: trace.x - formerTrace.x,\n        y: trace.y - formerTrace.y\n    }\n    const duration = trace.time - formerTrace.time\n    const velocityX = diff.x / duration || 0\n    const velocityY = diff.y / duration || 0\n    const angle = Math.atan2(Math.abs(diff.y), Math.abs(diff.x)) * delta\n\n    return {\n        ...diff,\n        angle,\n        velocityX,\n        velocityY\n    }\n}\n\nexport function Tracker (): Tracker {\n    let logs: TraceLogs = []\n\n    function push (position: Position): void {\n        logs.push({\n            time: Date.now(),\n            ...position\n        })\n    }\n\n    function vector (): Vector {\n        return Vector(logs, logs.length - 1)\n    }\n\n    function clear () {\n        logs = []\n    }\n\n    function getLogs () {\n        return logs\n    }\n\n    function getDuration (): number {\n        const first = logs[0]\n        const last = logs[logs.length - 1]\n\n        return first ? last.time - first.time : 0\n    }\n\n    function getOffset (): Offset {\n        const first = logs[0]\n        const last = logs[logs.length - 1]\n\n        return first ? {\n            x: last.x - first.x,\n            y: last.y - first.y\n        } : {\n            x: 0,\n            y: 0\n        }\n    }\n\n    return {\n        getDuration,\n        getOffset,\n        getLogs,\n        vector,\n        clear,\n        push\n    }\n}\n","import { Tracker } from './trace'\n\nexport interface State {\n    tracker: Tracker\n    index: number\n    startTransform: number\n    isStart: boolean\n    isScrolling: boolean\n    isTouching: boolean\n    transforms: number\n    progress: number\n}\n\nexport function State (): State {\n    const state: State = {\n        tracker: Tracker(),\n        index: 0,\n        startTransform: 0,\n        isStart: false,\n        isScrolling: false,\n        isTouching: false,\n        transforms: 0,\n        progress: 0\n    }\n\n    return state\n}\n","import { Tick } from './nextTick'\n\nexport type Animation = {\n    run (task: (interval: DOMHighResTimeStamp) => void): void\n    stop (): void\n}\n\nexport function Animation (): Animation {\n    const tick = Tick()\n\n    function run (task: (interval: DOMHighResTimeStamp) => void): void {\n        tick.run((interval: DOMHighResTimeStamp) => {\n            run(task)\n            task(interval)\n        })\n    }\n\n    function stop (): void {\n        tick.stop()\n    }\n\n    return {\n        run,\n        stop\n    }\n}\n","import { Position } from '../state/trace'\nimport { Options } from '../options'\nimport { Env } from '../env/index'\nimport { State } from '../state/index'\nimport { Operations } from '../state/operations'\nimport { Animation } from '../render/animation'\n\nexport type Actions = {\n    preheat (\n        originPosition: Position,\n        originTransform: number\n    ): void\n    move (position: Position): void\n    stop (): void\n}\n\nfunction resetState (\n    state: State,\n    operations: Operations\n): void {\n    const {\n        tracker\n    } = state\n    const {\n        initStatus\n    } = operations\n\n    tracker.clear()\n    initStatus()\n}\n\nexport function Actions (\n    options: Options,\n    env: Env,\n    state: State,\n    operations: Operations\n) {\n    const {\n        initLayout,\n        initStatus,\n        render,\n        scrollPixel,\n        slideTo,\n        getOffsetSteps\n    } = operations\n    const animation = Animation()\n\n    function preheat (\n        originPosition: Position,\n        originTransform: number\n    ): void {\n        const { tracker } = state\n\n        animation.stop()\n        tracker.clear()\n        tracker.push(originPosition)\n        initLayout(originTransform)\n        initStatus(originTransform)\n        state.isStart = true\n\n        render()\n    }\n\n    function move (position: Position): void {\n        const {\n            tracker\n        } = state\n        const {\n            touchRatio,\n            touchAngle,\n            isHorizontal\n        } = options\n\n        if (!state.isStart || state.isScrolling) return\n\n        tracker.push(position)\n\n        const vector = tracker.vector()\n        const displacement = tracker.getOffset()\n\n        // Ignore this move action if there is no displacement of screen touch point.\n        // In case of minimal mouse move event. (Moving mouse extreme slowly will get the zero offset.)\n        if (!displacement.x && !displacement.y) return\n\n        if ((isHorizontal && (vector.angle < touchAngle))\n            || (!isHorizontal && (90 - vector.angle) < touchAngle)\n            || state.isTouching\n        ) {\n            const offset = vector[isHorizontal ? 'x' : 'y'] * touchRatio\n\n            state.isTouching = true\n            scrollPixel(offset)\n            render()\n        } else {\n            state.isScrolling = true\n            tracker.clear()\n        }\n    }\n\n    function stop (): void {\n        const {\n            index,\n            tracker\n        } = state\n        const {\n            measure\n        } = env\n\n        if (!state.isStart) return\n\n        state.isStart = false\n\n        if (!options.freeMode) {\n            const duration = tracker.getDuration()\n            const trans = tracker.getOffset()[options.isHorizontal ? 'x' : 'y']\n            const jump = Math.ceil(Math.abs(trans) / measure.boxSize)\n            const longSwipeIndex = getOffsetSteps(trans)\n\n            if (duration > options.longSwipesMs) {\n                // long swipe action\n                slideTo(index + longSwipeIndex * (trans > 0 ? -1 : 1))\n            } else {\n                // short swipe action\n                slideTo(trans > 0 ? index - jump : index + jump)\n            }\n\n            resetState(state, operations)\n        } else {\n            const vector = tracker.vector()\n\n            let velocity = vector[options.isHorizontal ? 'velocityX' : 'velocityY']\n\n            animation.run((duration: number) => {\n                const offset = velocity * duration\n\n                velocity *= 0.98\n\n                if (Math.abs(offset) < 0.01) {\n                    animation.stop()\n                    resetState(state, operations)\n                } else {\n                    scrollPixel(offset)\n                    render(0)\n                }\n            })\n        }\n    }\n\n    return {\n        preheat,\n        move,\n        stop\n    }\n}\n","import { State } from '../state/index'\nimport { Env } from '../env/index'\nimport { attachListener, detachListener, getTranslate } from '../render/dom'\nimport { Options } from '../options'\nimport { Position } from '../state/trace'\nimport { Actions } from './actions'\nimport { Operations } from '../state/operations'\n\nexport type Sensor = {\n    attach: () => void\n    detach: () => void\n}\n\n// Only support single finger touch event.\nexport function Sensor (\n    env: Env,\n    state: State,\n    options: Options,\n    operations: Operations\n): Sensor {\n    const {\n        touchable\n    } = env\n    const formEls = [\n        'INPUT',\n        'SELECT',\n        'OPTION',\n        'TEXTAREA',\n        'BUTTON',\n        'VIDEO'\n    ]\n    const actions = Actions(options, env, state, operations)\n    const {\n        preheat,\n        move,\n        stop\n    } = actions\n\n    function getPosition (e: Event): Position {\n        const touch = touchable ? (<TouchEvent>e).changedTouches[0] : <MouseEvent>e\n\n        return {\n            x: touch.pageX,\n            y: touch.pageY\n        }\n    }\n\n    function onTouchStart (e: Event): void {\n        for (let i = 0; i < options.excludeElements.length; i++) {\n            if (options.excludeElements[i].contains(e.target as Node)) return\n        }\n\n        const {\n            $wrapper\n        } = env.element\n        const shouldPreventDefault = (options.touchStartPreventDefault && formEls.indexOf((<HTMLElement>e.target).nodeName) === -1)\n            || options.touchStartForcePreventDefault\n\n        // `preventDefault` can not be called with `passiveListeners`\n        //      See: https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener\n        //      And: https://github.com/WICG/EventListenerOptions/blob/gh-pages/explainer.md\n        if (!touchable && shouldPreventDefault) e.preventDefault()\n\n        preheat(\n            getPosition(e),\n            getTranslate($wrapper, options.isHorizontal)\n        )\n    }\n\n    function onTouchMove (e: Event): void {\n        if (options.touchMoveStopPropagation) e.stopPropagation()\n\n        move(getPosition(e))\n\n        if (state.isTouching && e.cancelable !== false) e.preventDefault()\n    }\n\n    function onTouchEnd (): void {\n        stop()\n    }\n\n    function attach (): void {\n        const {\n            $el\n        } = env.element\n\n        if (touchable) {\n            attachListener($el, 'touchstart', onTouchStart, {\n                passive: options.passiveListeners,\n                capture: false\n            })\n            attachListener($el, 'touchmove', onTouchMove)\n            attachListener($el, 'touchend', onTouchEnd)\n            attachListener($el, 'touchcancel', onTouchEnd)\n        } else {\n            attachListener($el, 'mousedown', onTouchStart)\n            attachListener(document, 'mousemove', onTouchMove)\n            attachListener(document, 'mouseup', onTouchEnd)\n        }\n    }\n\n    function detach (): void {\n        const {\n            $el\n        } = env.element\n\n        detachListener($el, 'touchstart', onTouchStart)\n        detachListener($el, 'touchmove', onTouchMove)\n        detachListener($el, 'touchend', onTouchEnd)\n        detachListener($el, 'touchcancel', onTouchEnd)\n        detachListener($el, 'mousedown', onTouchStart)\n        detachListener(document, 'mousemove', onTouchMove)\n        detachListener(document, 'mouseup', onTouchEnd)\n    }\n\n    return {\n        attach,\n        detach\n    }\n}\n","import { Options } from '../options'\nimport { Element } from './element'\n\nexport type Measure = {\n    boxSize: number\n    viewSize: number\n    slideSize: number\n}\n\nexport function Measure (\n    options: Options,\n    element: Element\n): Measure {\n    const {\n        $el\n    } = element\n    const viewSize = options.isHorizontal ? $el.offsetWidth : $el.offsetHeight\n    const slideSize = (viewSize - (Math.ceil(options.slidesPerView - 1)) * options.spaceBetween) / options.slidesPerView\n    const boxSize = slideSize + options.spaceBetween\n\n    return {\n        boxSize,\n        viewSize,\n        slideSize\n    }\n}\n","import { Options } from '../options'\nimport { Element } from './element'\nimport { Measure } from './measure'\n\nexport type Limitation = {\n    min: number\n    max: number\n    base: number\n    expand: number\n    buffer: number\n    minIndex: number\n    maxIndex: number\n}\n\nexport function getExpand (\n    options: Options\n): number {\n    if (options.loop) {\n        // return options.slidesPerView >= element.$list.length\n        //     ? options.slidesPerView - element.$list.length + 1\n        //     : 1\n        return Math.ceil(options.slidesPerView)\n    }\n    return 0\n}\n\nexport function Limitation (\n    element: Element,\n    measure: Measure,\n    options: Options\n): Limitation {\n    const {\n        $list\n    } = element\n    const {\n        viewSize,\n        slideSize,\n        boxSize\n    } = measure\n    const expand = getExpand(options)\n    const buffer = expand * boxSize\n    const base = -buffer + (options.centeredSlides\n        ? (viewSize - slideSize) / 2\n        : 0)\n    // [min, max] usually equal to [-x, 0]\n    const max = base\n    const min = options.spaceBetween + (options.loop ? slideSize : viewSize) + base - boxSize * $list.length\n    const minIndex = 0\n    const maxIndex = $list.length - ((options.centeredSlides || options.loop)\n        ? 1\n        : Math.ceil(options.slidesPerView))\n\n    const limitation = {\n        max,\n        min,\n        base,\n        expand,\n        buffer,\n        minIndex,\n        maxIndex\n    }\n\n    return limitation\n}\n","import { Options } from '../options'\nimport { Element } from './element'\nimport { Measure } from './measure'\nimport { Limitation } from './limitation'\n\ndeclare global {\n    interface Window {\n        DocumentTouch: any\n    }\n    const DocumentTouch: any\n}\n\nexport type Env = {\n    touchable: boolean\n    element: Element\n    measure: Measure\n    limitation: Limitation\n    update (element: Element): void\n}\n\nexport function Env (\n    elem: Element,\n    options: Options\n): Env {\n    const env = <Env>{}\n\n    function update (element: Element): void {\n        const measure = Measure(\n            options,\n            element\n        )\n        const limitation = Limitation(\n            element,\n            measure,\n            options\n        )\n        const touchable = Boolean(\n            'ontouchstart' in window\n            || navigator.maxTouchPoints > 0\n            || navigator.msMaxTouchPoints > 0\n            || window.DocumentTouch && document instanceof DocumentTouch\n        )\n\n        Object.assign(env, {\n            touchable,\n            element,\n            measure,\n            limitation\n        })\n    }\n\n    env.update = update\n\n    update(elem)\n\n    return env\n}\n","import { Options } from '../options'\nimport {\n    removeClass, addClass, setStyle, setAttr, attachListener, detachListener\n} from './dom'\nimport { State } from '../state/index'\nimport { Env } from '../env/index'\n\nconst shallowTag = 'data-shallow-slider'\nconst sliderTag = 'data-slider'\n\nexport type Renderer = {\n    init (): void\n    render (\n        state: State,\n        duration?: number,\n        cb?: Function,\n        force?: boolean\n    ): void\n    destroy (): void\n    updateSize (): void\n}\n\nexport function Renderer (\n    env: Env,\n    options: Options\n): Renderer {\n    function updateItem (state: State): void {\n        const {\n            $wrapper\n        } = env.element\n        const {\n            index\n        } = state\n\n        $wrapper.querySelectorAll(`[${sliderTag}]`).forEach($slide => {\n            // eslint-disable-next-line no-bitwise\n            const tagNumber = ~~<string>$slide.getAttribute(sliderTag)\n\n            removeClass(<HTMLElement>$slide, [\n                options.slidePrevClass,\n                options.slideNextClass,\n                options.slideActiveClass\n            ])\n\n            if (tagNumber === index) {\n                addClass(<HTMLElement>$slide, options.slideActiveClass)\n            }\n            if (tagNumber === index - 1) {\n                addClass(<HTMLElement>$slide, options.slidePrevClass)\n            }\n            if (tagNumber === index + 1) {\n                addClass(<HTMLElement>$slide, options.slideNextClass)\n            }\n        })\n    }\n\n    function render (\n        state: State,\n        duration?: number,\n        cb?: Function,\n        force?: false\n    ) {\n        const {\n            $wrapper\n        } = env.element\n        const timing = duration === undefined ? options.speed : duration\n\n        options.injections.translate(state, env, options, timing)\n\n        // Update slide style only if scroll action is end.\n        if (!state.isStart) updateItem(state)\n\n        force && getComputedStyle($wrapper).transform\n        cb && setTimeout(cb, timing)\n    }\n\n    function appendExpandList (): void {\n        if (!options.loop) return\n\n        const {\n            element,\n            limitation\n        } = env\n        const {\n            $list,\n            $wrapper\n        } = element\n        const {\n            expand\n        } = limitation\n        const $leftExpandList = $list.slice(-expand)\n            .map($slide => <HTMLElement>$slide.cloneNode(true))\n        const $rightExpandList = $list.slice(0, expand)\n            .map($slide => <HTMLElement>$slide.cloneNode(true))\n\n        $leftExpandList.forEach(($shadowSlide, index) => {\n            $wrapper.appendChild(setAttr($rightExpandList[index], shallowTag))\n            $wrapper.insertBefore(setAttr($leftExpandList[index], shallowTag), $list[0])\n        })\n    }\n\n    function destroyExpandList (): void {\n        env.element.$wrapper\n            .querySelectorAll(`[${shallowTag}]`)\n            .forEach(item => env.element.$wrapper.removeChild(item))\n    }\n\n    function updateDom (): void {\n        env.element.$list.forEach((el, index) => setAttr(el, sliderTag, <any>index))\n\n        destroyExpandList()\n        appendExpandList()\n    }\n\n    function updateSize (): void {\n        const {\n            element,\n            measure\n        } = env\n        const {\n            $wrapper\n        } = element\n        const wrapperStyle = {\n            display: 'flex',\n            willChange: 'transform',\n            flexDirection: options.isHorizontal ? 'row' : 'column'\n        }\n        const itemStyle = {\n            [options.isHorizontal ? 'width' : 'height']: `${measure.slideSize}px`,\n            [options.isHorizontal ? 'margin-right' : 'margin-bottom']: `${options.spaceBetween}px`\n        }\n\n        setStyle($wrapper, wrapperStyle)\n        $wrapper.querySelectorAll(`[${sliderTag}]`)\n            .forEach($slide => setStyle(<HTMLElement>$slide, itemStyle))\n    }\n\n    function init (): void {\n        updateDom()\n        updateSize()\n    }\n\n    function destroy (): void {\n        const {\n            $list,\n            $wrapper\n        } = env.element\n        const arr = ['display', 'will-change', 'flex-direction']\n        const itemProp = options.isHorizontal ? 'margin-right' : 'margin-bottom'\n\n        arr.forEach((propertyName: string) => {\n            $wrapper.style.removeProperty(propertyName)\n        })\n        $list.forEach($slide => $slide.style.removeProperty(itemProp))\n        destroyExpandList()\n    }\n\n    return {\n        init,\n        render,\n        destroy,\n        updateSize\n    }\n}\n","import { State } from './index'\nimport { Limitation } from '../env/limitation'\nimport { EventHub, LIFE_CYCLES } from '../eventHub'\nimport { Renderer } from '../render/index'\nimport { Options } from '../options'\nimport { Env } from '../env/index'\n\nexport interface Operations {\n    update (): void\n    render (duration?: number): void\n    transform (trans: number): void\n    slideTo (\n        targetIndex: number,\n        duration?: number\n    ): void\n    scrollPixel (px: number): void\n    initStatus (startTransform?: number): void\n    initLayout (originTransform: number): void\n    getOffsetSteps (offset: number): number\n}\n\n/**\n * Detect whether slides is rush out boundary.\n * @param velocity - Velocity larger than zero means that slides move to the right direction\n * @param transform\n * @param limitation\n */\nexport function isExceedingLimits (\n    velocity: number,\n    transform: number,\n    limitation: Limitation\n): boolean {\n    return velocity > 0 && transform > (limitation.max)\n        || velocity < 0 && transform < (limitation.min)\n}\n\n/**\n * Return the shortest way to target Index.\n *      Negative number indicate the left direction, Index's value is decreasing.\n *      Positive number means index should increase.\n * @param currentIndex\n * @param targetIndex\n * @param limitation\n * @param defaultWay\n */\nexport function getShortestWay (\n    currentIndex: number,\n    targetIndex: number,\n    limitation: Limitation,\n    defaultWay: number\n): number {\n    const {\n        maxIndex,\n        minIndex\n    } = limitation\n\n    // Source expression show below:\n    // const shortcut = defaultWay > 0\n    //     ? minIndex - currentIndex + (targetIndex - maxIndex) - 1\n    //     : maxIndex - currentIndex + (targetIndex - minIndex) + 1\n\n    const shortcut = (defaultWay > 0 ? 1 : -1) * (minIndex - maxIndex - 1)\n        + targetIndex - currentIndex\n\n    return Math.abs(defaultWay) > Math.abs(shortcut)\n        ? shortcut\n        : defaultWay\n}\n\n/**\n * Get transform exceed value\n * Return zero if is not reached border.\n *\n * @param transform\n * @param limitation\n */\nexport function getExcess (\n    transform: number,\n    limitation: Limitation\n): number {\n    const exceedLeft = transform - limitation.max\n    const exceedRight = transform - limitation.min\n\n    return exceedLeft > 0\n        ? exceedLeft\n        : exceedRight < 0\n            ? exceedRight\n            : 0\n}\n\n/**\n * The Set of state operations.\n * Every external Render/Sensor/DomHandler are called by this Internal state machine.\n * That gives us the possibility to run Tiny-Swiper in different platform.\n *\n * @param env\n * @param state\n * @param options\n * @param renderer\n * @param eventHub\n * @constructor\n */\nexport function Operations (\n    env: Env,\n    state: State,\n    options: Options,\n    renderer: Renderer,\n    eventHub: EventHub\n): Operations {\n\n    /**\n     * Calculate the steps amount (boxSize) of offset.\n     *  eg: offset = 100, boxSize: 50, steps may equal to 2.\n     * @param offset\n     */\n    function getOffsetSteps (offset: number): number {\n        const {\n            measure\n        } = env\n        return Math.ceil(Math.abs(offset) / measure.boxSize - options.longSwipesRatio)\n    }\n\n    /**\n     * Call renderer's render function with default params.\n     * @param duration\n     * @param cb\n     * @param force\n     */\n    function render (\n        duration?: number,\n        cb?: Function,\n        force?: boolean\n    ): void {\n        renderer.render(\n            state,\n            duration,\n            cb,\n            force\n        )\n    }\n\n    /**\n     * Update Swiper transform attr.\n     * @param trans\n     */\n    function transform (trans: number): void {\n        const {\n            min,\n            max\n        } = env.limitation\n        const transRange = max - min + (options.loop ? env.measure.boxSize : 0)\n        const len = transRange + 1\n\n        let progress\n\n        state.transforms = trans\n\n        if (options.loop) {\n            progress = (max - trans) % len / transRange\n\n            state.progress = progress < 0\n                ? 1 + progress\n                : progress > 1\n                    ? progress - 1\n                    : progress\n        } else {\n            progress = (max - trans) / transRange\n\n            state.progress = progress < 0\n                ? 0\n                : progress > 1\n                    ? 1\n                    : progress\n        }\n\n        eventHub.emit(LIFE_CYCLES.SCROLL, {\n            ...state\n        })\n    }\n\n    /**\n     * Update Swiper transform state with certain Index.\n     * @param targetIndex\n     * @param duration\n     */\n    function slideTo (\n        targetIndex: number,\n        duration?: number\n    ): void {\n        const {\n            measure,\n            limitation\n        } = env\n        const len = limitation.maxIndex - limitation.minIndex + 1\n        const computedIndex = options.loop\n            ? (targetIndex % len + len) % len\n            : targetIndex > limitation.maxIndex\n                ? limitation.maxIndex\n                : targetIndex < limitation.minIndex\n                    ? limitation.minIndex\n                    : targetIndex\n        const newTransform = -computedIndex * measure.boxSize + limitation.base\n\n        // Slide to wrapper's boundary while touch end.\n        //  Math.abs(excess)  0\n        // Old condition: state.index === computedIndex\n        if (getOffsetSteps(newTransform - state.transforms) !== 0\n            && options.loop\n        ) {\n            const excess = getExcess(state.transforms, limitation)\n            const defaultWay = computedIndex - state.index\n            const shortcut = getShortestWay(\n                state.index,\n                computedIndex,\n                limitation,\n                defaultWay\n            )\n\n            if (shortcut !== defaultWay && !excess) {\n                transform(shortcut < 0\n                    ? limitation.min - measure.boxSize\n                    : limitation.max + measure.boxSize)\n            } else if (state.index === computedIndex) {\n                transform(excess > 0\n                    ? limitation.min - measure.boxSize + excess\n                    : limitation.max + measure.boxSize + excess)\n            }\n            // Set initial offset for rebounding animation.\n            render(0, undefined, true)\n        }\n\n        eventHub.emit(LIFE_CYCLES.BEFORE_SLIDE,\n            state.index,\n            state,\n            computedIndex)\n        state.index = computedIndex\n        transform(newTransform)\n        render(duration, () => {\n            eventHub.emit(LIFE_CYCLES.AFTER_SLIDE,\n                computedIndex,\n                state)\n        })\n    }\n\n    /**\n     * Scroll pixel by pixel while user dragging.\n     * @param px\n     */\n    function scrollPixel (px: number): void {\n        const {\n            transforms\n        } = state\n        const {\n            measure,\n            limitation\n        } = env\n        const ratio = Number(px.toExponential().split('e')[1])\n        const expand = ratio <= 0 ? Math.pow(10, -(ratio - 1)) : 1\n\n        let newTransform = transforms\n\n        // For optimizing, do not calculate `px` if options.loop === true\n        if (options.resistance && !options.loop) {\n            if (px > 0 && transforms >= limitation.max) {\n                px -= (px * expand) ** options.resistanceRatio / expand\n            } else if (px < 0 && transforms <= limitation.min) {\n                px += ((-px * expand) ** options.resistanceRatio) / expand\n            }\n        }\n\n        newTransform += px\n\n        if (options.loop) {\n            const vector = state.tracker.vector()\n            const velocity = options.isHorizontal ? vector.velocityX : vector.velocityY\n            const excess = getExcess(transforms, limitation)\n\n            if (excess && isExceedingLimits(\n                velocity,\n                transforms,\n                limitation\n            )) {\n                newTransform = excess > 0\n                    ? limitation.min - measure.boxSize + excess\n                    : limitation.max + measure.boxSize + excess\n            }\n        }\n\n        transform(newTransform)\n    }\n\n    function initStatus (startTransform = 0): void {\n        state.startTransform = startTransform\n        state.isStart = false\n        state.isScrolling = false\n        state.isTouching = false\n    }\n\n    function initLayout (originTransform: number): void {\n        transform(originTransform)\n    }\n\n    function update (): void {\n        slideTo(state.index, 0)\n        renderer.updateSize()\n    }\n\n    return {\n        update,\n        render,\n        transform,\n        slideTo,\n        scrollPixel,\n        initStatus,\n        initLayout,\n        getOffsetSteps\n    }\n}\n","import { Options } from '../options'\n\nexport type Element = {\n    $el: HTMLElement\n    $list: Array<HTMLElement>\n    $wrapper: HTMLElement\n}\n\nexport function Element (\n    el: HTMLElement | string,\n    options: Options\n): Element {\n    const $el = <HTMLElement>(typeof el === 'string' ? document.body.querySelector(el) : el)\n    const $wrapper = <HTMLElement>$el!.querySelector(`.${options.wrapperClass}`)\n    let $list = [].slice.call($el!.getElementsByClassName(options.slideClass))\n    $list = $list.filter((slide: HTMLElement) => slide.getAttribute('data-shallow-slider') === null)\n\n    return {\n        $el,\n        $wrapper,\n        $list\n    }\n}\n","import { UserOptions, optionFormatter, Options } from './options'\nimport { EventHub, LIFE_CYCLES } from './eventHub'\nimport { State } from './state/index'\nimport { Sensor } from './sensor/index'\nimport { Env } from './env/index'\nimport { Renderer } from './render/index'\nimport { Operations } from './state/operations'\nimport { Element } from './env/element'\n\nexport type SwiperInstance = {\n    on: (evtName: string, cb: Function) => void\n    off: (evtName: string, cb: Function) => void\n    update: () => void\n    destroy: () => void\n    slideTo: (index: number, duration?: number) => void\n    options: Options\n    env: Env\n    state: State\n    updateSize: () => void\n\n    // mount plugin instance\n    [key: string]: any\n}\n\nexport type SwiperPlugin = (instance: SwiperInstance, options: Options) => void\n\nexport type Swiper = {\n    (el: HTMLElement | string, userOptions?: UserOptions): SwiperInstance\n    new (el: HTMLElement | string, userOptions?: UserOptions): SwiperInstance\n    use: (plugins: Array<SwiperPlugin>) => void\n    plugins: Array<SwiperPlugin>\n}\n\nconst Swiper: Swiper = <Swiper> function (\n    el: HTMLElement | string,\n    userOptions: UserOptions\n): SwiperInstance {\n    const options = optionFormatter(userOptions)\n    const eventHub = EventHub()\n    const element = Element(\n        el,\n        options\n    )\n    const env = Env(element, options)\n    const state = State()\n    const {\n        on,\n        off,\n        emit\n    } = eventHub\n    const instance = {\n        on,\n        off,\n        env,\n        state,\n        options\n    } as SwiperInstance\n\n    (options.plugins || Swiper.plugins || [])\n        .forEach((plugin: SwiperPlugin) => plugin(\n            instance,\n            options\n        ))\n\n    emit(LIFE_CYCLES.BEFORE_INIT, instance)\n\n    // Initialize internal module\n    const renderer = Renderer(\n        env,\n        options\n    )\n    const operations = Operations(\n        env,\n        state,\n        options,\n        renderer,\n        eventHub\n    )\n    const sensor = Sensor(\n        env,\n        state,\n        options,\n        operations\n    )\n\n    function destroy (): void {\n        emit(LIFE_CYCLES.BEFORE_DESTROY, instance)\n        sensor.detach()\n        renderer.destroy()\n        emit(LIFE_CYCLES.AFTER_DESTROY, instance)\n        eventHub.clear()\n    }\n\n    function updateSize (): void {\n        env.update(Element(\n            el,\n            options\n        ))\n        operations.update()\n    }\n\n    function update (): void {\n        renderer.destroy()\n        env.update(Element(\n            el,\n            options\n        ))\n        renderer.init()\n        operations.update()\n    }\n\n    const {\n        slideTo\n    } = operations\n\n    Object.assign(instance, {\n        update,\n        destroy,\n        slideTo,\n        updateSize\n    })\n\n    renderer.init()\n    sensor.attach()\n    slideTo(\n        options.initialSlide,\n        0\n    )\n    emit(LIFE_CYCLES.AFTER_INIT, instance)\n\n    return instance\n}\n\nSwiper.use = (plugins: Array<SwiperPlugin>): void => {\n    Swiper.plugins = plugins\n}\n\nexport default Swiper\n"],"names":["addClass","el","list","Array","isArray","forEach","clz","classList","contains","add","removeClass","remove","attachListener","evtName","handler","opts","addEventListener","detachListener","removeEventListener","setAttr","attr","value","setAttribute","setStyle","style","forceRender","Object","keys","prop","getComputedStyle","getTranslate","isHorizontal","matrix","transform","replace","split","map","parseFloat","arr","length","slice","stringToElement","string","wrapper","document","createElement","innerHTML","firstChild","SwiperPluginLazyload","instance","options","isEnable","Boolean","lazyload","lazyloadOptions","assign","loadPrevNext","loadPrevNextAmount","loadOnTransitionStart","elementClass","loadingClass","loadedClass","preloaderClass","load","index","$slide","env","element","$list","$imgs","call","getElementsByClassName","$preloaders","handleLoaded","$img","removeAttribute","onload","onerror","isLoaded","every","item","$preloader","parentElement","removeChild","hasAttribute","src","getAttribute","loadRange","range","i","on","oldIndex","state","newIndex","SwiperPluginPagination","pagination","paginationOptions","clickable","bulletClass","bulletActiveClass","clickableClass","paginationInstance","$pageList","$pagination","renderBullet","body","querySelector","$group","createDocumentFragment","dotCount","Math","ceil","slidesPerView","excludeElements","push","$page","appendChild","e","target","preventDefault","bulletElement","closest","slideTo","indexOf","stopPropagation","currentIndex","DIRECTION","up","right","down","left","isVisible","visible","visibility","display","nodeType","isElementInView","boundary","getBoundingClientRect","isInView","top","bottom","window","innerHeight","innerWidth","SwiperPluginKeyboardControl","keyboard","keyboardOptions","enabled","onlyInViewport","enable","disable","onKeyDown","key","$el","SwiperPluginMousewheel","mousewheel","mousewheelOptions","invert","sensitivity","interval","mousewheelInstance","wheelStatus","wheeling","wheelDelta","wheelingTimer","abs","deltaX","deltaY","delta","step","setTimeout","SwiperPluginNavigation","navigation","navigationInstance","nextEl","prevEl","navigationOptions","disabledClass","nextClickHandler","clickHandler","prevClickHandler","type","checkIsDisable","loop","checkNavBtnDisabledClass","limitation","minIndex","maxIndex","checkButtonDefaultStatus","now","performance","Date","debounce","fn","threshold","opt","trailing","lastCallTime","lastResult","lastTimer","args","currTime","clearTimeout","LIFE_CYCLES","BEFORE_INIT","AFTER_INIT","BEFORE_SLIDE","SCROLL","AFTER_SLIDE","BEFORE_DESTROY","AFTER_DESTROY","EventHub","hub","cb","off","splice","emit","data","clear","nextFrame","requestAnimationFrame","webkitRequestAnimationFrame","cancelNextFrame","cancelAnimationFrame","webkitCancelAnimationFrame","Tick","startTime","id","run","timeStamp","stop","undefined","SwiperPluginBreakpoints","isEnabled","breakpoints","update","entries","breakpoint","values","breakpointsBase","matchMedia","matches","offsetWidth","updateSize","resizeListener","passive","translate","duration","$wrapper","wrapperStyle","transition","isStart","transforms","defaultOptions","direction","touchRatio","touchAngle","longSwipesRatio","initialSlide","freeMode","passiveListeners","resistance","resistanceRatio","speed","longSwipesMs","spaceBetween","centeredSlides","slidePrevClass","slideNextClass","slideActiveClass","slideClass","wrapperClass","touchStartPreventDefault","touchStartForcePreventDefault","touchMoveStopPropagation","injections","optionFormatter","userOptions","PI","Vector","logs","trace","formerTrace","diff","x","y","time","velocityX","velocityY","angle","atan2","Tracker","position","vector","getLogs","getDuration","first","last","getOffset","State","tracker","startTransform","isScrolling","isTouching","progress","Animation","tick","task","resetState","operations","initStatus","Actions","initLayout","render","scrollPixel","getOffsetSteps","animation","preheat","originPosition","originTransform","move","displacement","offset","measure","trans","jump","boxSize","longSwipeIndex","velocity","Sensor","touchable","formEls","actions","getPosition","touch","changedTouches","pageX","pageY","onTouchStart","shouldPreventDefault","nodeName","onTouchMove","cancelable","onTouchEnd","attach","capture","detach","Measure","viewSize","offsetHeight","slideSize","getExpand","Limitation","expand","buffer","base","max","min","Env","elem","navigator","maxTouchPoints","msMaxTouchPoints","DocumentTouch","shallowTag","sliderTag","Renderer","updateItem","querySelectorAll","tagNumber","force","timing","appendExpandList","$leftExpandList","cloneNode","$rightExpandList","$shadowSlide","insertBefore","destroyExpandList","updateDom","willChange","flexDirection","itemStyle","init","destroy","itemProp","propertyName","removeProperty","isExceedingLimits","getShortestWay","targetIndex","defaultWay","shortcut","getExcess","exceedLeft","exceedRight","Operations","renderer","eventHub","transRange","len","computedIndex","newTransform","excess","px","ratio","Number","toExponential","pow","Element","filter","slide","Swiper","plugins","plugin","sensor","use"],"mappings":"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"}